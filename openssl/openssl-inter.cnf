####################################################################
# Certificate Extensions for Different Types
####################################################################

[ usr_cert ]        # Regular user cert
basicConstraints = CA:FALSE
nsCertType = client, email
keyUsage = digitalSignature, keyEncipherment
extendedKeyUsage = clientAuth, emailProtection
subjectKeyIdentifier = hash
authorityKeyIdentifier = keyid,issuer

[ server_cert ]     # Server cert (for TLS/HTTPS)
basicConstraints = CA:FALSE
nsCertType = server
keyUsage = digitalSignature, keyEncipherment
extendedKeyUsage = serverAuth
subjectKeyIdentifier = hash
authorityKeyIdentifier = keyid,issuer
# For SAN: set dynamically during CSR creation or via -addext
# Example: subjectAltName = @alt_names

[ smartcard_cert ]  # Smart card / hardware token cert
basicConstraints = CA:FALSE
keyUsage = digitalSignature, nonRepudiation
extendedKeyUsage = clientAuth, smartcardlogon
subjectKeyIdentifier = hash
authorityKeyIdentifier = keyid,issuer

[ admin_cert ]      # Admin cert â€” restricted via SAN
basicConstraints = CA:FALSE
keyUsage = digitalSignature, keyEncipherment
extendedKeyUsage = clientAuth
subjectKeyIdentifier = hash
authorityKeyIdentifier = keyid,issuer
# Hardcoded SANs for admin identity
subjectAltName = @admin_san

[ admin_san ]
DNS.1 = admin.local
email.1 = admin@example.com
